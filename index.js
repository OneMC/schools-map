!function(t){var n={};function e(i){if(n[i])return n[i].exports;var a=n[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,e),a.l=!0,a.exports}e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:i})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(e.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var a in t)e.d(i,a,function(n){return t[n]}.bind(null,a));return i},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=4)}([function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class i{constructor(t){this.ele=t}ready(t){this.ele===document.documentElement&&(window.onload=t)}query(t){const n=this.ele.querySelector(t);return new i(n)}append(t){this.ele.appendChild(t.ele)}prepend(t){this.ele.insertBefore(t.ele,this.ele.firstElementChild)}visible(t){const n=this.ele;t?n.style.display=this.styleDisplayCache||"block":(this.styleDisplayCache||(this.styleDisplayCache=n.style.display),n.style.display="none")}text(t){if("string"!=typeof t)return this.ele.innerHTML;this.ele.innerHTML=t}value(t){if(this.ele instanceof HTMLInputElement){if("string"!=typeof t)return this.ele.value;this.ele.value=t}}click(t){this.clickCallback&&this.ele.removeEventListener("click",this.clickCallback),t&&(this.ele.addEventListener("click",t),this.clickCallback=t)}}n.JEle=i,n.jQuery=function(t){if("string"==typeof t){if(!t.trim().startsWith("<"))return new i(document.querySelector(t));{const n=(new DOMParser).parseFromString(t,"text/html").body.firstElementChild;if(n)return new i(n)}}return t instanceof Element?new i(t):t instanceof Document?new i(t.documentElement):null}},function(t,n,e){"use strict";t.exports=function(t){var n=[];return n.toString=function(){return this.map(function(n){var e=function(t,n){var e=t[1]||"",i=t[3];if(!i)return e;if(n&&"function"==typeof btoa){var a=(o=i,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"),r=i.sources.map(function(t){return"/*# sourceURL="+i.sourceRoot+t+" */"});return[e].concat(r).concat([a]).join("\n")}var o;return[e].join("\n")}(n,t);return n[2]?"@media "+n[2]+"{"+e+"}":e}).join("")},n.i=function(t,e){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},a=0;a<this.length;a++){var r=this[a][0];null!=r&&(i[r]=!0)}for(a=0;a<t.length;a++){var o=t[a];null!=o[0]&&i[o[0]]||(e&&!o[2]?o[2]=e:e&&(o[2]="("+o[2]+") and ("+e+")"),n.push(o))}},n}},function(t,n,e){var i,a,r={},o=(i=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===a&&(a=i.apply(this,arguments)),a}),s=function(t){var n={};return function(t,e){if("function"==typeof t)return t();if(void 0===n[t]){var i=function(t,n){return n?n.querySelector(t):document.querySelector(t)}.call(this,t,e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}n[t]=i}return n[t]}}(),c=null,l=0,u=[],d=e(8);function M(t,n){for(var e=0;e<t.length;e++){var i=t[e],a=r[i.id];if(a){a.refs++;for(var o=0;o<a.parts.length;o++)a.parts[o](i.parts[o]);for(;o<i.parts.length;o++)a.parts.push(f(i.parts[o],n))}else{var s=[];for(o=0;o<i.parts.length;o++)s.push(f(i.parts[o],n));r[i.id]={id:i.id,refs:1,parts:s}}}}function N(t,n){for(var e=[],i={},a=0;a<t.length;a++){var r=t[a],o=n.base?r[0]+n.base:r[0],s={css:r[1],media:r[2],sourceMap:r[3]};i[o]?i[o].parts.push(s):e.push(i[o]={id:o,parts:[s]})}return e}function h(t,n){var e=s(t.insertInto);if(!e)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var i=u[u.length-1];if("top"===t.insertAt)i?i.nextSibling?e.insertBefore(n,i.nextSibling):e.appendChild(n):e.insertBefore(n,e.firstChild),u.push(n);else if("bottom"===t.insertAt)e.appendChild(n);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var a=s(t.insertAt.before,e);e.insertBefore(n,a)}}function g(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var n=u.indexOf(t);n>=0&&u.splice(n,1)}function j(t){var n=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var i=function(){0;return e.nc}();i&&(t.attrs.nonce=i)}return p(n,t.attrs),h(t,n),n}function p(t,n){Object.keys(n).forEach(function(e){t.setAttribute(e,n[e])})}function f(t,n){var e,i,a,r;if(n.transform&&t.css){if(!(r="function"==typeof n.transform?n.transform(t.css):n.transform.default(t.css)))return function(){};t.css=r}if(n.singleton){var o=l++;e=c||(c=j(n)),i=z.bind(null,e,o,!1),a=z.bind(null,e,o,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(e=function(t){var n=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",p(n,t.attrs),h(t,n),n}(n),i=function(t,n,e){var i=e.css,a=e.sourceMap,r=void 0===n.convertToAbsoluteUrls&&a;(n.convertToAbsoluteUrls||r)&&(i=d(i));a&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */");var o=new Blob([i],{type:"text/css"}),s=t.href;t.href=URL.createObjectURL(o),s&&URL.revokeObjectURL(s)}.bind(null,e,n),a=function(){g(e),e.href&&URL.revokeObjectURL(e.href)}):(e=j(n),i=function(t,n){var e=n.css,i=n.media;i&&t.setAttribute("media",i);if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}.bind(null,e),a=function(){g(e)});return i(t),function(n){if(n){if(n.css===t.css&&n.media===t.media&&n.sourceMap===t.sourceMap)return;i(t=n)}else a()}}t.exports=function(t,n){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(n=n||{}).attrs="object"==typeof n.attrs?n.attrs:{},n.singleton||"boolean"==typeof n.singleton||(n.singleton=o()),n.insertInto||(n.insertInto="head"),n.insertAt||(n.insertAt="bottom");var e=N(t,n);return M(e,n),function(t){for(var i=[],a=0;a<e.length;a++){var o=e[a];(s=r[o.id]).refs--,i.push(s)}t&&M(N(t,n),n);for(a=0;a<i.length;a++){var s;if(0===(s=i[a]).refs){for(var c=0;c<s.parts.length;c++)s.parts[c]();delete r[s.id]}}}};var y,v=(y=[],function(t,n){return y[t]=n,y.filter(Boolean).join("\n")});function z(t,n,e,i){var a=e?"":i.css;if(t.styleSheet)t.styleSheet.cssText=v(n,a);else{var r=document.createTextNode(a),o=t.childNodes;o[n]&&t.removeChild(o[n]),o.length?t.insertBefore(r,o[n]):t.appendChild(r)}}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class i{constructor(){this.bMap=new BMap.Map("container"),this.overlays=[],this.bMap.enableScrollWheelZoom()}center(t,n){this.bMap.centerAndZoom(new BMap.Point(t,n),i.zoomLevel)}showRegion(t){for(const n of t.schools)this.drawSchool(n)}drawSchool(t){"string"==typeof t.value&&(t.value=[t.value]);for(const n of t.value)this.drawShape(n,t.title)}drawShape(t,n,e){const{marker:a,polygon:r}=i.drawSchoolShape(this.bMap,t,n,e);this.overlays.push(a),this.overlays.push(r)}clear(){for(const t of this.overlays)this.bMap.removeOverlay(t)}static drawSchoolShape(t,n,e,a){const r=n.split(";").map(t=>t.split(",").map(Number));let o=null;o=a?a.split(",").map(Number):r.reduce(function(t,n){return t[0]+=n[0],t[1]+=n[1],t},[0,0]).map(t=>t/r.length);const s=new BMap.Marker(new BMap.Point(o[0],o[1]));t.addOverlay(s);const c=new BMap.Label(e,{offset:new BMap.Size(20,-10)});s.setLabel(c);const l=new BMap.Polygon(r.map(t=>new BMap.Point(t[0],t[1])),i.shapePolygonStyle);return t.addOverlay(l),{marker:s,polygon:l}}}i.zoomLevel=15,i.shapePolygonStyle={strokeWeight:2,strokeOpacity:.5},n.MapManager=i},function(t,n,e){"use strict";var i=this&&this.__awaiter||function(t,n,e,i){return new(e||(e=Promise))(function(a,r){function o(t){try{c(i.next(t))}catch(t){r(t)}}function s(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){t.done?a(t.value):new e(function(n){n(t.value)}).then(o,s)}c((i=i.apply(t,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0});const a=e(0),r=e(5),o=e(10),s=e(12),c=e(3),l=e(16),u=e(19);e(20),a.jQuery(document).ready(function(){return i(this,void 0,void 0,function*(){const t=new r.DialogManager,n=new o.DataManager,e=new s.PageManager,a=new c.MapManager,d=new l.DrawManager(a,t,function(t){e.setDrawStatus(t)});e.fillRegions(yield n.getRegionOultines()),e.onStartDraw(()=>d.startDraw()),e.onUndoDraw(()=>d.undoDraw()),e.onClearDraw(()=>d.clearDraw()),e.onOutputDraw(()=>d.outputDraw()),new u.AppRouter(yield n.firstRegionId(),function(t){return i(this,void 0,void 0,function*(){const i=yield n.getRegionDetail(t);i&&(e.setCurrentRegion(i),a.clear(),a.center(i.center[0],i.center[1]),a.showRegion(i))})})})})},function(t,n,e){"use strict";var i=this&&this.__awaiter||function(t,n,e,i){return new(e||(e=Promise))(function(a,r){function o(t){try{c(i.next(t))}catch(t){r(t)}}function s(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){t.done?a(t.value):new e(function(n){n(t.value)}).then(o,s)}c((i=i.apply(t,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0});const a=e(0);e(6);const r=e(9);n.DialogManager=class{constructor(){this.$dialog=a.jQuery(r.default),this.$input=this.$dialog.query(".input"),this.$confirm=this.$dialog.query(".confirm"),this.$cancel=this.$dialog.query(".cancel"),this.$message=this.$dialog.query(".dialog-message"),a.jQuery(document.body).append(this.$dialog)}prompt(t){return i(this,void 0,void 0,function*(){return this.$message.text(t),this.$input.visible(!0),this.$cancel.visible(!0),new Promise((t,n)=>{this.$dialog.visible(!0),this.$confirm.click(()=>{this.$dialog.visible(!1);const n=this.$input.value();this.$input.value(""),t(n)}),this.$cancel.click(()=>{this.$dialog.visible(!1),this.$input.value(""),t(null)})})})}confirm(t){return i(this,void 0,void 0,function*(){return this.$message.text(t),this.$input.visible(!1),this.$cancel.visible(!0),new Promise((t,n)=>{this.$dialog.visible(!0),this.$confirm.click(()=>{this.$dialog.visible(!1),t(!0)}),this.$cancel.click(()=>{this.$dialog.visible(!1),t(!1)})})})}alert(t){return i(this,void 0,void 0,function*(){return this.$message.text(t),this.$input.visible(!1),this.$cancel.visible(!1),new Promise((t,n)=>{this.$dialog.visible(!0),this.$confirm.click(()=>{this.$dialog.visible(!1),t()}),this.$cancel.click(()=>{})})})}}},function(t,n,e){var i=e(7);"string"==typeof i&&(i=[[t.i,i,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};e(2)(i,a);i.locals&&(t.exports=i.locals)},function(t,n,e){(t.exports=e(1)(!1)).push([t.i,"body {\n  margin: 0px;\n  padding: 0px;\n  font-family: 'Verdana', 'Hiragino Sans GB', 'Microsoft Yahei', sans-serif;\n}\n#header {\n  height: 58px;\n  border-bottom: 3px solid #57606f;\n  background: #2f3542;\n  color: #f1f2f6;\n}\n#container {\n  height: calc(100vh - 58px - 3px);\n}\n.dialog {\n  display: none;\n  border-radius: 6px;\n  width: 400px;\n  height: 140px;\n  padding: 20px;\n  position: absolute;\n  z-index: 100;\n  left: calc(50vw - 400px/2 - 20px);\n  top: calc(50vh - 140px/2 - 20px);\n  border-right: 3px solid #57606f;\n  border-bottom: 3px solid #57606f;\n  background: #2f3542;\n  color: #f1f2f6;\n}\n.dialog .dialog-message {\n  height: calc((140px - 40px)/2);\n}\n.dialog .dialog-input-container {\n  height: calc((140px - 40px)/2);\n  text-align: center;\n}\n.dialog .dialog-input-container input {\n  width: calc(400px - 20px);\n  line-height: 28px;\n  font-family: 'Verdana', 'Hiragino Sans GB', 'Microsoft Yahei', sans-serif;\n  font-size: 16px;\n  text-align: center;\n}\n.dialog .dialog-buttons {\n  display: flex;\n  flex-direction: row-reverse;\n}\n.dialog .dialog-buttons .button {\n  border-radius: 5px;\n  padding: 4px 14px;\n  margin: 0 10px;\n  background: #f1f2f6;\n  color: #2f3542;\n  cursor: pointer;\n}\n.dialog .dialog-buttons .button:hover {\n  color: #eccc68;\n}\n.dialog .dialog-buttons .cancel {\n  border-radius: 5px;\n  padding: 4px 14px;\n  margin: 0 10px;\n  background: #f1f2f6;\n  color: #2f3542;\n  cursor: pointer;\n}\n.dialog .dialog-buttons .cancel:hover {\n  color: #eccc68;\n}\n.dialog .dialog-buttons .confirm {\n  border-radius: 5px;\n  padding: 4px 14px;\n  margin: 0 10px;\n  background: #f1f2f6;\n  color: #2f3542;\n  cursor: pointer;\n}\n.dialog .dialog-buttons .confirm:hover {\n  color: #eccc68;\n}\n",""])},function(t,n){t.exports=function(t){var n="undefined"!=typeof window&&window.location;if(!n)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var e=n.protocol+"//"+n.host,i=e+n.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,n){var a,r=n.trim().replace(/^"(.*)"$/,function(t,n){return n}).replace(/^'(.*)'$/,function(t,n){return n});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(r)?t:(a=0===r.indexOf("//")?r:0===r.indexOf("/")?e+r:i+r.replace(/^\.\//,""),"url("+JSON.stringify(a)+")")})}},function(t,n,e){"use strict";e.r(n),n.default='<div id="dialog" class="dialog">\n    <div class="dialog-message">\n        请按照提示进行操作。\n    </div>\n    <div class="dialog-input-container">\n        <input class="input" type="text">\n    </div>\n    <div class="dialog-buttons">\n        <div class="cancel">取消</div>\n        <div class="confirm">确认</div>\n    </div>\n</div>'},function(t,n,e){"use strict";var i=this&&this.__awaiter||function(t,n,e,i){return new(e||(e=Promise))(function(a,r){function o(t){try{c(i.next(t))}catch(t){r(t)}}function s(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){t.done?a(t.value):new e(function(n){n(t.value)}).then(o,s)}c((i=i.apply(t,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0});const a=e(11);n.DataManager=class{constructor(){this.regionOutlines=new Map,this.regionDetails=new Map}getRegionOultines(){return i(this,void 0,void 0,function*(){if(0===this.regionOutlines.size){const t=yield a.ajax("./data/index.json"),n=JSON.parse(t);for(const t of n)this.regionOutlines.set(t.id,t)}return this.regionOutlines})}getRegionDetail(t){return i(this,void 0,void 0,function*(){const n=yield this.getRegionOultines();if(!this.regionDetails.has(t)){const e=yield a.ajax(`./data/${t}.json`),i=JSON.parse(e);return this.regionDetails.set(t,i),Object.assign({},n.get(t),i)}return null})}firstRegionId(){return i(this,void 0,void 0,function*(){const t=yield this.getRegionOultines();return t.size>0?[...t.keys()][0]:null})}}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ajax=function(t){return new Promise((n,e)=>{var i=new XMLHttpRequest;i.onreadystatechange=function(){i.readyState==XMLHttpRequest.DONE&&(200==i.status?n(i.responseText):400==i.status&&e())},i.open("GET",t,!0),i.send()})}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const i=e(0);e(13);const a=e(15);n.PageManager=class{constructor(){this.$navBar=i.jQuery(a.default),this.$regionList=this.$navBar.query("#region-list"),this.$currentRegion=this.$navBar.query("#current-region"),this.$statucDraw=this.$navBar.query("#status-draw"),this.$buttonStartDraw=this.$navBar.query("#start-draw"),this.$buttonUndoDraw=this.$navBar.query("#undo-draw"),this.$buttonOutputDraw=this.$navBar.query("#output-draw"),this.$buttonClearDraw=this.$navBar.query("#clear-draw"),i.jQuery(document.body).prepend(this.$navBar)}fillRegions(t){for(const[n,e]of t){const t=i.jQuery(`<a class="dropdown-item" href="#${n}">${e.name}</a>`);this.$regionList.append(t)}}setCurrentRegion(t){this.$currentRegion.text(`区域选择:${t.name}`)}setDrawStatus(t){t?this.$statucDraw.text(`绘制中：${t.name}`):this.$statucDraw.text("绘图")}onStartDraw(t){this.$buttonStartDraw.click(t)}onUndoDraw(t){this.$buttonUndoDraw.click(t)}onOutputDraw(t){this.$buttonOutputDraw.click(t)}onClearDraw(t){this.$buttonClearDraw.click(t)}}},function(t,n,e){var i=e(14);"string"==typeof i&&(i=[[t.i,i,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};e(2)(i,a);i.locals&&(t.exports=i.locals)},function(t,n,e){(t.exports=e(1)(!1)).push([t.i,"body {\n  margin: 0px;\n  padding: 0px;\n  font-family: 'Verdana', 'Hiragino Sans GB', 'Microsoft Yahei', sans-serif;\n}\n#header {\n  height: 58px;\n  border-bottom: 3px solid #57606f;\n  background: #2f3542;\n  color: #f1f2f6;\n}\n#container {\n  height: calc(100vh - 58px - 3px);\n}\n.navbar {\n  display: flex;\n  align-items: center;\n}\n.navbar .icon {\n  background-size: 100%;\n  width: 30px;\n  height: 30px;\n  margin: 0 10px;\n  padding: 0;\n}\n.navbar .navbar-item {\n  margin: 0px 30px;\n}\n.navbar .navbar-item:hover {\n  cursor: pointer;\n}\n.navbar .navbar-item:hover .nav-menu {\n  display: flex;\n}\n.navbar .navbar-item.nav-flag-region {\n  min-width: 200px;\n  text-align: left;\n  align-self: flex-start;\n  line-height: 58px;\n}\n.navbar .navbar-item .nav-menu {\n  position: relative;\n  z-index: 100;\n  display: none;\n  flex-direction: column;\n  padding: 0 20px;\n  background: #3f4552;\n  border-bottom: 3px solid #57606f;\n  border-right: 3px solid #57606f;\n}\n.navbar .navbar-item .nav-menu a {\n  line-height: 42px;\n  text-decoration: none;\n  color: #f1f2f6;\n}\n.navbar .navbar-item .nav-menu a:hover {\n  color: #eccc68;\n}\n.navbar .navbar-item.icon-edit {\n  background-image: url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTUzOTMzODkyOTczIiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjI5ODciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNODUuMzMzMzMzIDg1LjMzMzMzMyA4NS4zMzMzMzMgMzQxLjMzMzMzMyAxODIuNjEzMzMzIDM0MS4zMzMzMzMgMjM3LjY1MzMzMyA2ODIuNjY2NjY3IDE3MC42NjY2NjcgNjgyLjY2NjY2NyAxNzAuNjY2NjY3IDkzOC42NjY2NjcgNDI2LjY2NjY2NyA5MzguNjY2NjY3IDQyNi42NjY2NjcgODU1Ljg5MzMzMyA2NDAgODU1LjQ2NjY2NyA2NDAgOTM4LjY2NjY2NyA4OTYgOTM4LjY2NjY2NyA4OTYgNjgyLjY2NjY2NyA4MTcuOTIgNjgyLjY2NjY2NyA4NTMuMzMzMzMzIDM4NCA5MzguNjY2NjY3IDM4NCA5MzguNjY2NjY3IDEyOCA2ODIuNjY2NjY3IDEyOCA2ODIuNjY2NjY3IDI3OC42MTMzMzMgNjMxLjQ2NjY2NyAzNDEuMzMzMzMzIDQwOS4xNzMzMzMgMzQxLjMzMzMzMyAzNDEuMzMzMzMzIDI0OC4zMiAzNDEuMzMzMzMzIDg1LjMzMzMzM00xNzAuNjY2NjY3IDE3MC42NjY2NjcgMjU2IDE3MC42NjY2NjcgMjU2IDI1NiAxNzAuNjY2NjY3IDI1Nk03NjggMjEzLjMzMzMzMyA4NTMuMzMzMzMzIDIxMy4zMzMzMzMgODUzLjMzMzMzMyAyOTguNjY2NjY3IDc2OCAyOTguNjY2NjY3TTI2OS4yMjY2NjcgMzQxLjMzMzMzMyAzMDMuMzYgMzQxLjMzMzMzMyAzODQgNDUxLjg0IDM4NCA1OTcuMzMzMzMzIDY0MCA1OTcuMzMzMzMzIDY0MCA0NjUuNDkzMzMzIDcwNi45ODY2NjcgMzg0IDc2OCAzODQgNzMyLjE2IDY4Mi42NjY2NjcgNjQwIDY4Mi42NjY2NjcgNjQwIDc3MC41NiA0MjYuNjY2NjY3IDc3MC41NiA0MjYuNjY2NjY3IDY4Mi42NjY2NjcgMzI0LjI2NjY2NyA2ODIuNjY2NjY3TTQ2OS4zMzMzMzMgNDI2LjY2NjY2NyA1NTQuNjY2NjY3IDQyNi42NjY2NjcgNTU0LjY2NjY2NyA1MTIgNDY5LjMzMzMzMyA1MTJNMjU2IDc2OCAzNDEuMzMzMzMzIDc2OCAzNDEuMzMzMzMzIDg1My4zMzMzMzMgMjU2IDg1My4zMzMzMzNNNzI1LjMzMzMzMyA3NjggODEwLjY2NjY2NyA3NjggODEwLjY2NjY2NyA4NTMuMzMzMzMzIDcyNS4zMzMzMzMgODUzLjMzMzMzMyIgcC1pZD0iMjk4OCIgZmlsbD0iI2U2ZTZlNiI+PC9wYXRoPjwvc3ZnPg==');\n  background-size: 100%;\n  width: 30px;\n  height: 30px;\n  margin: 0 10px;\n  padding: 0;\n}\n.navbar .navbar-item.icon-undo {\n  background-image: url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTUzOTMxODQzNzEyIiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjEwOTMiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNODYyLjcyIDg5NmE0Mi42NjY2NjcgNDIuNjY2NjY3IDAgMCAxLTQyLjY2NjY2Ny0zMi40MjY2NjcgMzgwLjE2IDM4MC4xNiAwIDAgMC0zMzIuOC0yODUuNDR2NDcuNzg2NjY3YTc1Ljk0NjY2NyA3NS45NDY2NjcgMCAwIDEtNDYuNTA2NjY2IDY5Ljk3MzMzM0E4NS4zMzMzMzMgODUuMzMzMzMzIDAgMCAxIDM0OS4wMTMzMzMgNjgyLjY2NjY2N2wtMjE1Ljg5MzMzMy0xODguMTZhNzUuMDkzMzMzIDc1LjA5MzMzMyAwIDAgMSAwLTExNC4zNDY2NjdsMjE1Ljg5MzMzMy0xODguNTg2NjY3YTg1LjMzMzMzMyA4NS4zMzMzMzMgMCAwIDEgOTMuMDEzMzM0LTEyLjggNzUuOTQ2NjY3IDc1Ljk0NjY2NyAwIDAgMSA0Ni41MDY2NjYgNjkuOTczMzM0VjI5OC42NjY2NjdBNDY0LjY0IDQ2NC42NCAwIDAgMSA5MTcuMzMzMzMzIDc1Ny4zMzMzMzNhNDM5LjA0IDQzOS4wNCAwIDAgMS0xMy4yMjY2NjYgMTA2LjI0IDQyLjY2NjY2NyA0Mi42NjY2NjcgMCAwIDEtNDIuNjY2NjY3IDMyLjQyNjY2N3oiIHAtaWQ9IjEwOTQiIGZpbGw9IiNlNmU2ZTYiPjwvcGF0aD48L3N2Zz4=');\n  background-size: 100%;\n  width: 30px;\n  height: 30px;\n  margin: 0 10px;\n  padding: 0;\n}\n.navbar .navbar-item.icon-clear {\n  background-image: url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTUzOTMzODI1ODcyIiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjIwOTEiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNODI0LjQgNDM4LjhjMC0zNy42LTMwLTY3LjYtNjcuNi02Ny42bC0xMzUuMiAwTDYyMS42IDEwNC44YzAtMzcuNi0zMC02Ny42LTY3LjYtNjcuNi0zNy42IDAtNjcuNiAzMC02Ny42IDY3LjZsMCAyNjYuNEwzNTguOCAzNzEuMmMtMzcuNiAwLTY3LjYgMzAtNjcuNiA2Ny42bDAgNjcuNkw4MjggNTA2LjRsMC02Ny42TDgyNC40IDQzOC44IDgyNC40IDQzOC44ek04MjQuNCA1NzRjLTExLjIgMC01MzYuOCAwLTUzNi44IDBTMjUwIDk3MiA4OC40IDk3MkwyODAgOTcyYzc1LjIgMCAxMDguOC0yMTcuNiAxMDguOC0yMTcuNnMzMy42IDE5NS4yIDMuNiAyMTcuNmwxMDUuMiAwYy0zLjYgMCAwIDAgMTEuMiAwIDUyLjQtNy42IDYwLTI0Ny42IDYwLTI0Ny42czUyLjQgMjQ0IDQ1LjIgMjQ0Yy0yNi40IDAtNzguOCAwLTEwNS4yIDBsMCAwIDE1NCAwYy03LjYgMCAwIDAgMTEuMiAwIDQ4LjgtMTEuMiA1Mi40LTE4Ny42IDUyLjQtMTg3LjZzMjIuNCAxODcuNiAxNS4yIDE4Ny42Yy0xOC44IDAtNDguOCAwLTY3LjYgMGwtMy42IDAgOTAgMEM4OTUuNiA5NzIgOTAzLjIgNzg0LjQgODI0LjQgNTc0TDgyNC40IDU3NHoiIHAtaWQ9IjIwOTIiIGZpbGw9IiNlNmU2ZTYiPjwvcGF0aD48L3N2Zz4=');\n  background-size: 100%;\n  width: 30px;\n  height: 30px;\n  margin: 0 10px;\n  padding: 0;\n}\n.navbar .navbar-item.icon-output {\n  background-image: url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTUzOTMzNDUwMTExIiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjczOCIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIj48ZGVmcz48c3R5bGUgdHlwZT0idGV4dC9jc3MiPjwvc3R5bGU+PC9kZWZzPjxwYXRoIGQ9Ik0xNzAuNjY2NjY3IDc2OG00Mi42NjY2NjYgMGw1OTcuMzMzMzM0IDBxNDIuNjY2NjY3IDAgNDIuNjY2NjY2IDQyLjY2NjY2N2wwIDBxMCA0Mi42NjY2NjctNDIuNjY2NjY2IDQyLjY2NjY2NmwtNTk3LjMzMzMzNCAwcS00Mi42NjY2NjcgMC00Mi42NjY2NjYtNDIuNjY2NjY2bDAgMHEwLTQyLjY2NjY2NyA0Mi42NjY2NjYtNDIuNjY2NjY3WiIgcC1pZD0iNzM5IiBmaWxsPSIjZTZlNmU2Ij48L3BhdGg+PHBhdGggZD0iTTE3MC42NjY2NjcgODUzLjMzMzMzM20wLTQyLjY2NjY2NmwwLTg1LjMzMzMzNHEwLTQyLjY2NjY2NyA0Mi42NjY2NjYtNDIuNjY2NjY2bDAgMHE0Mi42NjY2NjcgMCA0Mi42NjY2NjcgNDIuNjY2NjY2bDAgODUuMzMzMzM0cTAgNDIuNjY2NjY3LTQyLjY2NjY2NyA0Mi42NjY2NjZsMCAwcS00Mi42NjY2NjcgMC00Mi42NjY2NjYtNDIuNjY2NjY2WiIgcC1pZD0iNzQwIiBmaWxsPSIjZTZlNmU2Ij48L3BhdGg+PHBhdGggZD0iTTc2OCA4NTMuMzMzMzMzbTAtNDIuNjY2NjY2bDAtODUuMzMzMzM0cTAtNDIuNjY2NjY3IDQyLjY2NjY2Ny00Mi42NjY2NjZsMCAwcTQyLjY2NjY2NyAwIDQyLjY2NjY2NiA0Mi42NjY2NjZsMCA4NS4zMzMzMzRxMCA0Mi42NjY2NjctNDIuNjY2NjY2IDQyLjY2NjY2NmwwIDBxLTQyLjY2NjY2NyAwLTQyLjY2NjY2Ny00Mi42NjY2NjZaIiBwLWlkPSI3NDEiIGZpbGw9IiNlNmU2ZTYiPjwvcGF0aD48cGF0aCBkPSJNNTEyIDY0MGE0Mi42NjY2NjcgNDIuNjY2NjY3IDAgMCAxLTI0Ljc0NjY2Ny03LjY4bC0xNzAuNjY2NjY2LTEyMC4zMmE0Mi42NjY2NjcgNDIuNjY2NjY3IDAgMCAxLTEwLjI0LTU5LjMwNjY2NyA0Mi42NjY2NjcgNDIuNjY2NjY3IDAgMCAxIDU5LjczMzMzMy0xMC4yNEw1MTIgNTQ0LjQyNjY2N2wxNDUuMDY2NjY3LTEwOS4yMjY2NjdhNDIuNjY2NjY3IDQyLjY2NjY2NyAwIDAgMSA1MS4yIDY4LjI2NjY2N2wtMTcwLjY2NjY2NyAxMjhhNDIuNjY2NjY3IDQyLjY2NjY2NyAwIDAgMS0yNS42IDguNTMzMzMzeiIgcC1pZD0iNzQyIiBmaWxsPSIjZTZlNmU2Ij48L3BhdGg+PHBhdGggZD0iTTUxMiA1NTQuNjY2NjY3YTQyLjY2NjY2NyA0Mi42NjY2NjcgMCAwIDEtNDIuNjY2NjY3LTQyLjY2NjY2N1YxNzAuNjY2NjY3YTQyLjY2NjY2NyA0Mi42NjY2NjcgMCAwIDEgODUuMzMzMzM0IDB2MzQxLjMzMzMzM2E0Mi42NjY2NjcgNDIuNjY2NjY3IDAgMCAxLTQyLjY2NjY2NyA0Mi42NjY2Njd6IiBwLWlkPSI3NDMiIGZpbGw9IiNlNmU2ZTYiPjwvcGF0aD48L3N2Zz4=');\n  background-size: 100%;\n  width: 30px;\n  height: 30px;\n  margin: 0 10px;\n  padding: 0;\n}\n.navbar .navbar-item .title {\n  display: none;\n  width: 60px;\n  padding: 3px;\n  border-radius: 5px;\n  border-right: 3px solid #57606f;\n  border-bottom: 3px solid #57606f;\n  text-align: center;\n  background: #3f4552;\n  color: #f1f2f6;\n  margin: 40px 0 0 -17px;\n  position: relative;\n  z-index: 100;\n}\n.navbar .navbar-item:hover .title {\n  display: block;\n}\n.navbar .navbar-item a {\n  text-decoration: none;\n  color: #f1f2f6;\n}\n.navbar .navbar-item a:hover {\n  color: #eccc68;\n}\n.navbar .navbar-item .link {\n  text-decoration: none;\n  color: #f1f2f6;\n}\n.navbar .navbar-item .link:hover {\n  color: #eccc68;\n}\n.navbar .navbar-splitter {\n  align-self: stretch;\n  margin: 12px 0;\n  width: 1px;\n  background: #aaa;\n}\n",""])},function(t,n,e){"use strict";e.r(n),n.default='<div id="header" class="navbar">\n    <div class="navbar-item">学区房地图</div>\n    <div class="navbar-item nav-flag-region">\n        <span id="current-region">区域选择:加载中</span>\n        <div id="region-list" class="nav-menu">\n        </div>\n    </div>\n    <div class="navbar-splitter"></div>\n    <div id="status-draw" class="navbar-item">绘图工具：</div>\n    <div id="start-draw" class="navbar-item icon-edit"><div class="title">绘图</div></div>\n    <div id="undo-draw" class="navbar-item icon-undo"><div class="title">撤回</div></div>\n    <div id="output-draw" class="navbar-item icon-output"><div class="title">导出</div></div>\n    <div id="clear-draw" class="navbar-item icon-clear"><div class="title">清除</div></div>\n    <div class="navbar-splitter"></div>\n    <div id="about" class="navbar-item">\n        <a href="https://github.com/xieguanglei/schools-map" target="_blank">关于</a>\n    </div>\n</div>'},function(t,n,e){"use strict";var i=this&&this.__awaiter||function(t,n,e,i){return new(e||(e=Promise))(function(a,r){function o(t){try{c(i.next(t))}catch(t){r(t)}}function s(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){t.done?a(t.value):new e(function(n){n(t.value)}).then(o,s)}c((i=i.apply(t,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0});const a=e(3),r=e(17),o=e(18);class s{constructor(t,n,e){this.data=null,this.polygons=[],this.markers=[],this.map=t,this.dialog=n,this.onDrawStatusChange=e,this.bMapDrawer=new BMapLib.DrawingManager(this.map.bMap,{isOpen:!1,enableDrawingTool:!1,polygonOptions:{strokeColor:"red",fillColor:"red",strokeWeight:3,strokeOpacity:.8,fillOpacity:.6,strokeStyle:"solid"}}),this.bMapDrawer.setDrawingMode(BMAP_DRAWING_POLYGON),this.bMapDrawer.addEventListener("overlaycomplete",t=>this.drawComplete(t)),this.restoreDrawData(),this.data&&this.onDrawStatusChange(this.data)}startDraw(){return i(this,void 0,void 0,function*(){if(!this.data){const t=yield this.dialog.prompt("输入即将绘制的区域的名称（如 杭州市西湖区）：");if(!t)return;this.data={name:t,schools:[]},yield r.wait(200),this.onDrawStatusChange(this.data),yield r.wait(200)}const t=yield this.dialog.prompt("输入即将绘制的学校名称：");if(t){const n=yield this.pushDraw(t);n&&(this.data.schools.push({title:t,value:[n]}),this.saveDrawData())}})}undoDraw(){return i(this,void 0,void 0,function*(){this.data&&this.data.schools?(yield this.dialog.confirm("你确定要撤回上一次绘图吗？撤回的数据将无法恢复。"))&&(this.markers.pop().remove(),this.polygons.pop().remove(),this.data.schools.pop(),this.saveDrawData()):yield this.dialog.alert("尚未开始绘图，无法执行「取消上一次绘图」。")})}clearDraw(){return i(this,void 0,void 0,function*(){if(yield this.dialog.confirm("你确定要清除所有绘图结果吗？被清除的数据将无法恢复。")){for(;this.markers.length>0;)this.markers.pop().remove();for(;this.polygons.length>0;)this.polygons.pop().remove();this.data=null,this.saveDrawData(),this.onDrawStatusChange(this.data)}})}outputDraw(){return i(this,void 0,void 0,function*(){this.data&&this.data.schools.length?(yield this.dialog.confirm("即将导出绘图数据。点击确定将开始下载数据文件，并跳转到 ISSUE 页。你可以通过此页面提交绘图数据（当然你也可以不提交），并合并到本网站中。"))&&(o.download(`学区数据-${this.data.name}`,JSON.stringify(this.data)),yield r.wait(1e3),window.open("https://github.com/xieguanglei/schools-map/issues/new")):yield this.dialog.alert("你还没有完成学区绘制（至少绘制一所学校的学区），请完成绘制后再导出。")})}pushDraw(t){return i(this,void 0,void 0,function*(){return new Promise(n=>{this.resolve=(e=>{this.drawSchool({title:t,value:[e]}),this.resolve=null,n(e)}),this.bMapDrawer.open()})})}pop(){this.polygons.pop().remove(),this.markers.pop().remove()}restoreDrawData(){const t=localStorage.getItem(s.LOCAL_STORAGE_KEY);if(t){this.data=JSON.parse(t);for(const t of this.data.schools)this.drawSchool(t)}}saveDrawData(){this.data?localStorage.setItem(s.LOCAL_STORAGE_KEY,JSON.stringify(this.data)):localStorage.removeItem(s.LOCAL_STORAGE_KEY)}drawSchool(t){for(const n of t.value){const{polygon:e,marker:i}=a.MapManager.drawSchoolShape(this.map.bMap,n,t.title);this.polygons.push(e),this.markers.push(i)}}drawComplete(t){const n=t.overlay.ia.map(t=>[t.lng,t.lat].join(",")).join(";");t.overlay.remove(),this.resolve&&this.resolve(n)}}s.LOCAL_STORAGE_KEY="map_drawing_data",n.DrawManager=s},function(t,n,e){"use strict";var i=this&&this.__awaiter||function(t,n,e,i){return new(e||(e=Promise))(function(a,r){function o(t){try{c(i.next(t))}catch(t){r(t)}}function s(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){t.done?a(t.value):new e(function(n){n(t.value)}).then(o,s)}c((i=i.apply(t,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0}),n.wait=function(t){return i(this,void 0,void 0,function*(){return new Promise(n=>{setTimeout(n,t)})})}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.download=function(t,n){var e=document.createElement("a");e.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(n)),e.setAttribute("download",t),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class i{get hash(){return location.hash.startsWith("#")?location.hash.substr(1):""}set hash(t){location.hash=t}constructor(){window.onhashchange=(()=>{this.onHashChange&&this.onHashChange(this.hash)})}}n.HashManager=i;n.AppRouter=class{constructor(t,n){this.hashManager=new i,this.hashManager.onHashChange=n,this.hashManager.hash?n(this.hashManager.hash):this.hashManager.hash=t}}},function(t,n,e){var i=e(21);"string"==typeof i&&(i=[[t.i,i,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};e(2)(i,a);i.locals&&(t.exports=i.locals)},function(t,n,e){(t.exports=e(1)(!1)).push([t.i,"body {\n  margin: 0px;\n  padding: 0px;\n  font-family: 'Verdana', 'Hiragino Sans GB', 'Microsoft Yahei', sans-serif;\n}\n#header {\n  height: 58px;\n  border-bottom: 3px solid #57606f;\n  background: #2f3542;\n  color: #f1f2f6;\n}\n#container {\n  height: calc(100vh - 58px - 3px);\n}\n",""])}]);